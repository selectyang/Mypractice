function Carousel(t){this.container=t,this.init(),this.resize(),this.bind(),this.autoPlay(3e3)}function carousel(t){t.each(function(t,n){new Carousel($(n))})}function GoTop(t){this.ct=t,this.target=$('<p class="gotop">GoTop</p>'),this.createNode(),this.bindEvent()}function Waterfall(){this.init(),this.bind()}Carousel.prototype.init=function(){this.$buttonPre=this.container.find(".pre"),this.$buttonNext=this.container.find(".next"),this.$imgCarousel=this.container.find(".carousel");var t=this.$imgContent=this.container.find(".img-content"),n=this.$imgs=this.container.find(".img-content img");this.$bullets=this.container.find(".bullet >li");this.pageIndex=0,this.islock=!0,this.imgLen=n.length,this.$imgs.width(window.innerWidth),t.append(n.first().clone()),t.prepend(n.last().clone()),t.css("width",$(".img-content img").length*window.innerWidth),t.css("left",-window.innerWidth)},Carousel.prototype.bind=function(){var t=this;this.$buttonPre.on("click",function(n){n.preventDefault(),t.islock&&t.playPre(1)}),this.$buttonNext.on("click",function(n){n.preventDefault(),t.islock&&t.playNext(1)}),this.$bullets.on("click",function(){var n=$(this).index();n>t.pageIndex?t.playNext(n-t.pageIndex):n<t.pageIndex&&t.playPre(t.pageIndex-n)})},Carousel.prototype.resize=function(){var t=this;$(window).resize(function(){t.container.find(".img-content img").width(window.innerWidth),t.$imgContent.css("width",$(".img-content img").length*window.innerWidth),t.$imgContent.css("left",-window.innerWidth)})},Carousel.prototype.autoPlay=function(t){var n=this;setInterval(function(){n.playNext(1)},t)},Carousel.prototype.playNext=function(t){var n=this;this.islock=!1,this.$imgContent.animate({left:"-="+window.innerWidth*t},function(){n.pageIndex+=t,n.pageIndex===n.imgLen&&(n.pageIndex=0,n.$imgContent.css("left",-window.innerWidth)),n.islock=!0,n.setbullet()})},Carousel.prototype.playPre=function(t){var n=this;n.islock=!1,this.$imgContent.animate({left:"+="+window.innerWidth*t},function(){n.pageIndex-=t,n.pageIndex<0&&(n.pageIndex=n.imgLen-1,n.$imgContent.css("left",-n.imgLen*window.innerWidth)),n.islock=!0,n.setbullet()})},Carousel.prototype.setbullet=function(){this.$bullets.removeClass("active").eq(this.pageIndex).addClass("active")},carousel($(".container")),GoTop.prototype.bindEvent=function(){var t=this;$(window).on("scroll",function(){$(window).scrollTop()>window.innerHeight?t.target.addClass("show"):t.target.removeClass("show")}),this.target.on("click",function(){$(window).scrollTop(0)})},GoTop.prototype.createNode=function(){var t=this;this.ct.append(t.target)},new GoTop($("body")),Waterfall.prototype.init=function(){this.getNews()},Waterfall.prototype.insetNode=function(t){var n=this;$.each(t,function(t,e){var i="";i+='<div class="item">',i+='<a class="link" href="'+e.url+'">',i+='<img src="'+e.img_url+'" alt=""></a>',i+='<h4 class="header" >'+e.name+"</h4>",i+='<p class="text" >'+e.short_intro+"</p>",i+="</div>",$(i).find("img").load(function(){$(".waterfall").append($(i)),n.render()})})},Waterfall.prototype.bind=function(){var t=this;$(".load").on("click",function(){t.getNews()})},Waterfall.prototype.getNews=function(){var t=this;$.ajax({url:"http://platform.sina.com.cn/slide/album_tech",dataType:"jsonp",jsonp:"jsoncallback",data:{app_key:"1271687855",num:t.perPageCount,page:t.pageIndex}}).done(function(n){console.log(n.status.code),"0"===n.status.code?(t.insetNode(n.data),t.pageIndex++):console.log("get error data")})},Waterfall.prototype.render=function(){for(var t=$(".item").outerWidth(!0),n=parseInt($(".waterfall").width()/t),e=[],i=0;i<n;i++)e.push(0);$(".item").each(function(){for(var n=$(this),i=0,o=e[0],a=0;a<e.length;a++)e[a]<o&&(i=a,o=e[a]);n.css({left:t*i,top:o}),e[i]+=n.outerHeight(!0),$(".waterfall").height(Math.max.apply(null,e))})},new Waterfall;